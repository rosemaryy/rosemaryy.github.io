<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="initial-scale=1, maximum-scale=1, user-scalable=no, width=device-width, shrink-to-fit=no">
    <link rel="stylesheet" href="css/style.css" />
    <title>The Digital Diplomat Display</title>
    <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
    <link rel="stylesheet" href="https://code.getmdl.io/1.1.3/material.indigo-pink.min.css">
  </head>

  <body>
    <div class="container">
      <span class="left mdl-layout mdl-layout--fixed-header">
        <header class="mdl-layout__header">
          <span class="mdl-layout-title">Explore the Digital Diplomat!</span>
        </header>
        <ul class="mdl-list">
          <li class="mdl-list__item template">
            <span class="mdl-list__item-primary-content">
              <button class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--colored"></button>
            </span>
          </li>
        </ul>
      </span>
      <span id="pcontainer" class="right"></span>
    </div>

    <script src="js/three/three.min.js"></script>
    <script src="js/panolens/panolens.min.js"></script>
    <script defer src="https://code.getmdl.io/1.1.3/material.min.js"></script>

    <div id="desc-container" style="display:none">
      <iframe src="https://www.youtube.com/embed/D7icsuamx5E"></iframe>
      <div class="title">Yeet</div>
      <div class="text">This is a test; we can make an iframe for the quiz (a little biger obviously - but this sorta popup could be used; we can even use this for the video resources they provided.
      woooooooo
    testing
  123
</div>
    </div>

    <script>

      function linkPanoRooms (panorama1, panorama2, vect1, vect2, size) {
        panorama1.link(panorama2, vect1, size); //img can be second param here
          //link pano2 to main room
        panorama2.link(panorama1, vect2, size);
      }

      function addToNavBar(hoverText, infospot) {
        var item = listItem.cloneNode( true );
        item.classList.remove( 'template' );
        item.querySelector( 'button' ).textContent = hoverText;
        item.addEventListener( 'click', onFocus.bind( infospot ), false );
        list.appendChild( item );
      }

      function linkPanoInfoSpot (vect, isAnimated, hoverText, panoramaRoom, isAddToNavBar) {
        // sizing s.t. further away appears smaller
        infoSpotSize = baseScale * vect.length() / radius;

        // Create info spot and add to sidebar
        infospot = new PANOLENS.Infospot( infoSpotSize, PANOLENS.DataImage.Info, isAnimated);
        infospot.position.copy( vect );
        infospot.addHoverText(hoverText);
        infospot.addEventListener('click', onFocus);
        panoramaRoom.add(infospot);

        // Add to left panel
        if (isAddToNavBar) {
          addToNavBar(hoverText, infospot);
        }
      }  

      function removeListElems(room1, room2) {
        //remove all but 1 elem from list1
        //append new elems from list 2 into list 1
        //remove 1st elem from list 1


      }
      function linkPanoInfoSpotWtInfo(vect, divContainer, isAddToNavBar, panoramaRoom, hoverText, image) {
        // sizing s.t. further away appears smaller
        infoSpotSize = baseScale * vect.length() / radius;

        // add infospot with info that pops up in same room
        infospot2 = new PANOLENS.Infospot( infoSpotSize, image);
        infospot2.position.copy(vect);
        infospot2.addHoverElement( document.getElementById(divContainer), 200 );

        panoramaRoom.add(infospot2);

        // Add to left panel
        if (isAddToNavBar) {
          addToNavBar(hoverText, infospot2);
        }
      }
      

      function onFocus () {
        this.focus( parameters.duration, TWEEN.Easing[ parameters.curve ][ parameters.easing ] );
      }


      function addScenes() {
        // Add panorama scenes to viewer
        /* Add all scenes to viewer */ // todo: maybe change so can add 1 scene at a time

        //viewer config: https://pchen66.github.io/Panolens/docs/index.html
        viewer = new PANOLENS.Viewer( { output: 'console', container: document.querySelector( '#pcontainer' ), autoHideInfospot: false, cameraFov: 90} );
        viewer.add( panorama, panorama_video, blackRoom); //todo: MANUALLY ADD NEW SCENES HERE RN // NEED TO MAKE FUNC S.T. ITS NOT MANUAL
        viewer.renderer.sortObjects = true;
      }

      var parameters, gui, panorama, panorama_video, viewer, radius, button, position, infospot, timerId, easingItem, list, listItem, index = 0, baseScale = 300;


      list = document.querySelector( '.mdl-list' );
      listItem = document.querySelector( '.mdl-list__item' );


      // Focus tweening parameter
      parameters = {
        amount: 50,
        duration: 1000,
        curve: 'Cubic',
        easing: 'In',
        iterative: false
      };

      // panorama = new PANOLENS.ImagePanorama('https://michelleFae.github.io/ImpactHack/tempIntroRoom/assets/exhibitRooms/whiteSpaceRoomv5.jpg');

      // panorama = new PANOLENS.CubePanorama( ['https://rosemaryy.github.io/impactHack/assets/walls/b.jpg', 'https://rosemaryy.github.io/impactHack/assets/walls/f.jpg',
      //   'https://rosemaryy.github.io/impactHack/assets/walls/l.jpg', 'https://rosemaryy.github.io/impactHack/assets/walls/r.jpg',
      //   'https://rosemaryy.github.io/impactHack/assets/walls/u.jpg', 'https://rosemaryy.github.io/impactHack/assets/walls/d.jpg'
      // ] );

      const path = 'assets/cubeWalls/';
      var roomColor = 'whiteRoom/';
      const format = '.png';
      panorama = new PANOLENS.CubePanorama( [
          path + roomColor + 'px' + format, path + roomColor+ 'nx' + format,
          path  + roomColor + 'py' + format, path + roomColor + 'ny' + format,
          path  + roomColor +  'pz' + format, path + roomColor + 'nz' + format
      ] );

      roomColor = 'blackRoom/';
      blackRoom = new PANOLENS.CubePanorama( [
          path + roomColor + 'px' + format, path + roomColor+ 'nx' + format,
          path  + roomColor + 'py' + format, path + roomColor + 'ny' + format,
          path  + roomColor +  'pz' + format, path + roomColor + 'nz' + format
      ] );


      // test panorama video
      panorama_video = new PANOLENS.VideoPanorama( 'https://pchen66.github.io/Panolens/examples/asset/textures/video/1941-battle-low.mp4' );
      // linkPanoRooms(panorama, panorama_video, new THREE.Vector3(3883.71, 745.13, -3047.48), new THREE.Vector3(4602.58, 1863.13, -547.70), 1000);
      linkPanoRooms (panorama, blackRoom, new THREE.Vector3(3883.71, 745.13, -3047.48), new THREE.Vector3(-5000.00, -877.80, 5.84), 1000); 
      linkPanoRooms (panorama, panorama_video, new THREE.Vector3(3983.71, 945.13, -3147.48), new THREE.Vector3(-5000.00, -877.80, 5.84), 1000); 
    
      // // Recording image dimensions
      const { edgeLength } = panorama;
      radius = edgeLength / 2;


      linkPanoInfoSpot (new THREE.Vector3(2383.71, 975.13, -3247.48), false, "heyyyyya", panorama, true);
      linkPanoInfoSpotWtInfo(new THREE.Vector3(3883.71, 745.13, -3047.48),"desc-container" , true, panorama, "hii", "https://michelleFae.github.io/ImpactHack/tempIntroRoom/assets/exhibitRooms/textSample.jpg");

      linkPanoInfoSpotWtInfo(new THREE.Vector3(3283.71, 345.13, -2000.48), 'desc-container', true,  panorama, "yey", PANOLENS.DataImage.Info);
  

      // Removes the template div from list
      list.removeChild(listItem);
      
      addScenes();

    </script>

  </body>
</html>